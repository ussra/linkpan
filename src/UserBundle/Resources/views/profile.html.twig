{% extends "UserBundle::userbase.html.twig" %}

{% block Title %}
    Profile
{% endblock %}

{% block pageContent %}
    <div style="margin-top:50px">
        <div class="x_panel">
            <div class="x_title">
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                {% set userProfile  = app.session.get('user_info') %}
                <!-- User Informations -->
                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 profile_left">
                    <div class="profile_img">
                        <div class="container" >
                            {% if userProfile.user_image == '' %}
                                {% set profileImage = 'default.png' %}
                                {% else %}
                                    {% set profileImage = userProfile.user_image %}
                            {% endif %}
                            <!-- Current avatar -->
                            {% if userProfile.user_membership == 'dockies' %}
                                <img class=" img-circle" src="{{ asset('images/profile/') }}{{ profileImage }}" id="img-main" height="200px" width="200px" style="position:absolute;">
                                <img class=" img-circle" src="{{ asset('Userscripts/img/Ace/Border.png') }}" id="im-cover" height="200px" width="200px" style="position:relative;">
                                {% else %}
                                    <img class=" img-circle" src="{{ asset('images/profile/') }}{{ profileImage }}" id="img-main" height="200px" width="200px" style="position:static;">
                                    <img class=" img-circle" src="{{ asset('Userscripts/img/Ace/Border.png') }}" id="im-cover" height="200px" width="200px" style="position:relative;display: none;">
                            {% endif %}

                        </div>
                    </div>
                    <div id="infos" class="row">
                        <div class="text-left">
                            <h3>{{ userProfile.user_first_name }} {{ userProfile.user_last_name }}</h3>
                        </div>
                        <ul class="list-unstyled user_data">
                            {% if userProfile.user_adress is not null %}
                                <li><i class="fa fa-map-marker user-profile-icon"></i>
                                    {{ userProfile.user_adress }}
                                </li>
                            {% endif %}

                            {% if userProfile.user_company_name is not null %}
                                <li>
                                    <i class="fa fa-briefcase user-profile-icon"></i>
                                        {{ userProfile.user_company_name }}
                                </li>
                            {% endif %}

                            {% if userProfile.user_website is not null %}
                                <li class="m-top-xs">
                                    <i class="fa fa-external-link user-profile-icon"></i>
                                        <a href="{{ userProfile.user_website }}" target="_blank">userProfile.user_website</a>
                                </li>
                            {% endif %}
                            <li>
                                <i class="fa fa-envelope-o user-profile-icon"></i>
                                {{ userProfile.user_email }}
                            </li>
                        </ul>
                        {% if user.id != userProfile.user_id %}
                            {% if userProfile.follow_result == 'follow' %}
                                <a href="{{ path('follow',{'tofollow': userProfile.user_id }) }}"><button type="button" class="btn btn-default btn-xs follow" title="follow"  > <i class="fa fa-plus"></i> </button></a>
                                {% else %}
                                    <a href="{{ path('unfollow',{'unfollow': userProfile.user_id,'type':'profile' }) }}"><button type="button" class="btn btn-danger btn-xs" title="unfollow" > <i class="fa fa-minus"></i> </button></a>
                            {% endif %}


                            <button type="button" class="btn btn-success btn-xs" title="contact" > <i class="fa fa-comments-o"></i> </button>
                            <a href="{{ (path('block',{'Toblock':userProfile.user_id})) }}"><button type="button" class="btn btn-danger btn-xs" title="block"> <i class="fa fa-ban"></i> </button></a>

                        {% endif %}
                    </div>

                </div>
                <!-- -->
                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12">
                    <div class="x_content" style="margin-left: 5%;">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                            <!-- required for floating -->
                            <!-- Nav tabs -->
                            <ul class="nav nav-tabs tabs-right">
                                <li class="active"><a href="#home-r"  data-toggle="tab">Recent Activity</a>
                                </li>
                                <li><a href="#profile-r" data-toggle="tab">Followers</a>
                                </li>
                                <li><a href="#messages-r" data-toggle="tab">Following</a>
                                </li>
                            </ul>
                        </div>

                        <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                            <!--******************* Tab panes *******************-->
                            <div class="tab-content">
                                <div class="tab-pane active" id="home-r">
                                    <div class="col-12">
                                        <ul class="list-unstyled msg_list">
                                            {{dump(app.session.get('profile_recent_activities'))}}
                                            {% for item in app.session.get('profile_recent_activities') %}
                                                <li>
                                                    <a>
                                                        <span class="message">
                                                            Description
                                                        </span>
                                                    </a>
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>

                                <div class="tab-pane" id="profile-r">
                                    <div class="row"> <!--group rows-->
                                        {% if userProfile.followers is not empty %}
                                            <h4><small>Followers : </small> {{ userProfile.followers|length }} </h4>
                                            {% for follower in userProfile.followers %}
                                                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12 text-center" >
                                                    <div class="bord">
                                                        {% if follower.follower_image is null %}
                                                            {% set followerImage = 'default.png' %}
                                                            {% else %}
                                                                {% set followerImage = follower.follower_image%}
                                                        {% endif %}
                                                        <img src="{{ asset('images/profile/') }}{{ followerImage }}" width="100 " height="100"/>
                                                        <h4>{{ follower.follower_first_name }} {{ follower.follower_last_name }}</h4>
                                                        <div class=""><h5>{{ follower.follower_company_name }}</h5></div>
                                                    </div>
                                                </div>
                                            {% endfor %}

                                            {% else %}
                                                <h4>No followers</h4>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="tab-pane" id="messages-r">
                                    <div class="row"> <!--group rows-->
                                        {% if userProfile.following is not empty %}
                                            <h4><small>Followings : </small> {{ userProfile.following|length }} </h4>
                                            {% for follower in userProfile.following %}
                                                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12 text-center" >
                                                    <div class="bord">
                                                        {% if follower.follower_image is null %}
                                                            {% set followerImage = 'default.png' %}
                                                        {% else %}
                                                            {% set followerImage = follower.follower_image%}
                                                        {% endif %}
                                                        <img src="{{ asset('images/profile/') }}{{ followerImage }}" width="100 " height="100"/>
                                                        <h4>{{ follower.follower_first_name }} {{ follower.follower_last_name }}</h4>
                                                        <div class=""><h5>{{ follower.follower_company_name }}</h5></div>
                                                    </div>
                                                </div>
                                            {% endfor %}

                                        {% else %}
                                            <h4>No followings</h4>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--************************ post and pans ************************-->
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <!-- Nav tabs -->
                            <div> Recent Activity </div>
                            <ul class="nav nav-tabs">
                                <li class="active">
                                    <a href="#poststab" data-toggle="tab">Posts</a>
                                </li>
                                <li>
                                    <a href="#panstab" data-toggle="tab">Pans</a>
                                </li>
                            </ul>
                            <!--end Nav tabs -->

                             <!-- Tab content -->
                             <div class="tab-content">
                                <!--*************** Posts ***************-->
                                <div class="tab-pane active" id="poststab">
                                    {% for item in app.session.get('profile_recent_activities') %}
                                       {% if item.type == 'post' || item.type == 'groupPost' %}
                                             <div class="panel" style="margin-top: 2.5%;">
                                            <div class="panel-body">
                                                <!-- Image -->
                                                <div class="fb-user-thumb" style="display:inline">
                                                    {% if item.post. is null %} {% set image = 'default.png' %} {% else %} {% set image = item.owner_image  %}{% endif %}
                                                    <a href="{{ path('search_profile',{'user':user.id}) }}"><img src="{{ asset('images/profile/') }}{{ image }}" class="img-circle" style="width: 70px;height: 70px;object-fit: cover;"></a>
                                                </div>
                                               
                                                <div class="fb-user-details">
                                                    <h3><a class="#" href="{{ path('search_profile',{'user':user.id}) }}">{{ item.owner_first_name }} {{ item.owner_last_name }}</a> {% if item.owner_company_name is not null %} <small> {{ item.owner_company_name }}</small> {% endif %}</h3>
                                                    <p>{% if item.post_boosted == 'boosted' %}<strong style="color:black">{{'BOOSTED'|trans}}</strong></strong> | {% endif %} {{ item.post_creation_date  }} {% if item.owner_adress is not null %} <small>in</small> {{ item.owner_adress }} {% endif %}</p>
                                                </div>


                                                <div class="clearfix"></div>

                                                <!-- display post content -->
                                                <p class="fb-user-status">
                                                    <div style="word-wrap:break-word">
                                                        {{ item.post_content }}
                                                    </div>
                                                    <br>
                                                    <!-- images + video -->
                                                    <div class="parent" style="max-width: 650px;">
                                                        {% if item.post_video is not null %}
                                                            {% if item.post_images >0 %}
                                                                {% if item.post_images|length == 1 %}<!-- 1 photo+video: -->
                                                                    <div style="max-width:600px">
                                                                        <video  class="Vidoe_Player" controls  playsinline  controls qualitychange>
                                                                            <source src="{{ asset('videos/') }}{{ item.post_video }}" type="video/mp4">
                                                                                {{'Your browser does not support the video tag.'|trans}}
                                                                        </video>
                                                                    </div>
                                                                    <div>
                                                                        <a  href="{{ asset('images/post/') }}{{ item.post_images|first }}" data-max-width="600" data-toggle="lightbox" data-gallery="{{ item.id }}"> <img src="{{ asset('images/post/') }}{{ item.post_images|first }}" id="post_img" class="post-1img-video img-responsive"></a>
                                                                    </div>
                                                                {% endif %}<!--end 1 photo+video: -->

                                                                {% if item.post_images|length == 2 or item.post_images|length == 3   %}<!--end 2 or 3 photo+video -->
                                                                    <div style="max-width:600px">
                                                                        <video  class="Vidoe_Player" controls  playsinline  controls qualitychange>
                                                                            <source src="{{ asset('videos/') }}{{ item.post_video }}" type="video/mp4">
                                                                            {{'Your browser does not support the video tag.'|trans}}
                                                                        </video>
                                                                    </div>

                                                                    <div>
                                                                        {% for img in item.post_images %}
                                                                            <a  href="{{ asset('images/post/') }}{{ img }}" data-toggle="lightbox" data-gallery="{{ item.id }}"> <img src="{{ asset('images/post/') }}{{ img }}" id="post_img" {% if item.post_images|length == 2 %}class="img-responsive post-2img-video" {% else %}class="post-3img-video-fixed img-responsive"{% endif %}></a>
                                                                        {% endfor %}
                                                                    </div>

                                                                {% endif %}<!--end 2 or 3 photo+video -->

                                                                {% if item.post_images|length > 3 %}<!--more than 3 photo+video: -->
                                                                    <div style="max-width:600px">
                                                                        <video  class="Vidoe_Player" controls  playsinline  controls qualitychange>
                                                                            <source src="{{ asset('videos/') }}{{ item.post_video }}" type="video/mp4">
                                                                            {{'Your browser does not support the video tag.'|trans}}
                                                                        </video>
                                                                    </div>

                                                                    <div>
                                                                        {% for img in item.post_images[0:2]  %}
                                                                            <a  href="{{ asset('images/post/') }}{{ img }}" data-toggle="lightbox"  data-gallery="{{ item.id }}"> <img src="{{ asset('images/post/') }}{{ img }}"  class="post-3img-video img-responsive"></a>
                                                                        {% endfor %}

                                                                        <a  href="{{ asset('images/post/') }}{{ item.post_images[2] }}" data-toggle="lightbox"  data-gallery="{{ item.id }}">
                                                                            <div class="post-3imgvid-wrapblack">

                                                                                <img src="{{ asset('images/post/') }}{{ item.post_images[2] }}"  class="post-3imgvid-blackimg img-responsive">

                                                                                <div class="post-3imgvid-count">
                                                                                    +{{ item.post_images|length - 2 }}
                                                                                </div>
                                                                            </div>
                                                                        </a>

                                                                        <!-- elements not showing, use data-remote -->
                                                                        {% for img in item.post_images[3:item.post_images|length] %}
                                                                            <div data-toggle="lightbox" data-gallery="{{ item.id }}" data-remote="{{ asset('images/post/') }}{{ img }}" ></div>
                                                                        {% endfor %}


                                                                    </div>

                                                                {% endif %}<!--end more than 3 photo+video: -->

                                                                {% if item.post_images|length == 0  %}
                                                                    <div style="max-width:600px">
                                                                        <video  class="Vidoe_Player" controls  playsinline  controls qualitychange>
                                                                            <source src="{{ asset('videos/') }}{{ item.post_video }}" type="video/mp4">
                                                                            {{'Your browser does not support the video tag.'|trans}}
                                                                        </video>
                                                                    </div>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endif %}

                                                        {% if item.post_video is null %}
                                                            {% if item.post_images|length == 1  %}<!--1 photo -->
                                                                <div>
                                                                    <a  href="{{ asset('images/post/') }}{{ item.post_images|first }}" data-max-width="1000" data-toggle="lightbox" data-gallery="{{ item.id }}"> <img src="{{ asset('images/post/') }}{{ item.post_images|first }}" id="post_img" class="post-1img img-responsive"></a>
                                                                </div>
                                                            {% endif %}<!--end 1 photo-->

                                                            {% if item.post_images|length == 2 or item.post_images|length == 3   %}<!--2 or 3 photo -->
                                                                <div>
                                                                    {% for img in item.post_images %}
                                                                        <a  href="{{ asset('images/post/') }}{{ img }}" data-toggle="lightbox" data-gallery="{{ item.id }}"> <img src="{{ asset('images/post/') }}{{ img }}" id="post_img" {% if item.post_images|length == 2 %}class="img-responsive post-2-img" {% else %}class="post-3-img img-responsive"{% endif %}></a>
                                                                    {% endfor %}
                                                                </div>
                                                            {% endif %}<!--end 2 or 3 photo -->

                                                            {% if item.post_images|length > 3   %} <!--more than 3 photo -->
                                                                <div>
                                                                    {% for img in item.post_images[0:2]  %}
                                                                        <a  href="{{ asset('images/post/') }}{{ img }}" data-toggle="lightbox"  data-gallery="{{ item.id }}"> <img src="{{ asset('images/post/') }}{{ img }}"  class="post-3img-video img-responsive"></a>
                                                                    {% endfor %}

                                                                    <a  href="{{ asset('images/post/') }}{{ item.post_images[2] }}" data-toggle="lightbox"  data-gallery="{{ item.id }}">
                                                                        <div class="post-3imgvid-wrapblack">

                                                                            <img src="{{ asset('images/post/') }}{{ item.post_images[2] }}"  class="post-3imgvid-blackimg img-responsive">

                                                                            <div class="post-3imgvid-count">
                                                                                +{{ item.post_images|length - 2 }}
                                                                            </div>
                                                                        </div>
                                                                    </a>
                                                                    <!-- elements not showing, use data-remote -->
                                                                    {% for img in item.post_images[3:item.post_images|length] %}
                                                                        <div data-toggle="lightbox" data-gallery="{{ item.id }}" data-remote="{{ asset('images/post/') }}{{ img }}" ></div>
                                                                    {% endfor %}
                                                                </div>
                                                            {% endif %}<!--more than 3 photo -->
                                                        {% endif %}


                                                    </div>
                                                </p>
                                            </div>
                                        </div>
                                       {% endif %}
                                       {% if item.type == 'pan' %}
                                       {% endif %}
                                    {% endfor %}
                                </div>
                                <!--***************end Posts ***************-->

                                <!--*************** Pans ***************-->
                                <div class="tab-pane" id="panstab">
                                    Pans
                                </div>
                                <!--***************end Pans ***************-->
                            </div>
                            <!--end Tab content -->
                        </div>
                        <!--************************ end post and pans ************************-->

            </div>

        </div>

    </div>

{% endblock %}

{% block scripts %}
    <!-- block -->
    <script>
        function block(userToBlock)
        {
            $.ajax({
                url: '{{ (path('block')) }}',
                type: 'POST',
                dataType: 'json',
                data:
                    {
                        'Toblock': userToBlock
                    },
                async: true,
                success: function (data)
                {
                    window.location.href = data
                }
            });
        }
    </script>
{% endblock %}


{% block privacy  %}
{% endblock %}